{% block doc -%}
<!DOCTYPE html>
<html{% block html_attribs %}{% endblock html_attribs %}>
{%- block html %}
  <head>
    {%- block head %}
      {% block title %}
        <title>Flask-app</title>
      {% endblock title %}

      {%- block metas %}
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="UTF-8">
      {%- endblock metas %}

      {%- block styles %}
        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous">
        <link rel="stylesheet" href="{{url_for('.static', filename='mobile.css')}}">
        <link rel="stylesheet" media="all and (min-width: 768px)" href="{{url_for('.static', filename='desktop.css')}}">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
        <style>
      
        </style>
      {%- endblock styles %}
    {%- endblock head %}
  </head>
  <body{% block body_attribs %} class="bg-dark" {% endblock body_attribs %}>
    {% block scripts %}
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous">
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"
          integrity="sha512-aMGMvNYu8Ue4G+fHa359jcPb1u+ytAF+P2SCb+PxrjCdO3n3ZTxJ30zuH39rimUggmTwmh2u7wvQsDTHESnmfQ=="
          crossorigin="anonymous"></script>
      <script type="text/javascript" charset="utf-8">
          document.addEventListener("DOMContentLoaded", function () {
              // Generate a unique client ID
              function generateClientId() {
                  const clientId = `${navigator.platform}-${navigator.userAgent}-${Date.now()}`;
                  return clientId;
              }

              // Store client ID in localStorage if not already present
              if (!localStorage.getItem('clientId')) {
                  localStorage.setItem('clientId', generateClientId());
              }

              const clientId = localStorage.getItem('clientId');

              // Connect to the Socket.IO server
              const socket = io();

              // Handle new connections
              socket.on('connect', () => {
                  socket.emit('client_info', {
                      clientId: clientId,
                      platform: navigator.platform,
                      userAgent: navigator.userAgent,
                  });
              });

              // Handle messages from the server
              socket.on('my_response', (msg, cb) => {
                console.log(msg);
                const counter = document.getElementById("counter");
                counter.innerHTML = "Count # " + msg.count;
                //log.appendChild(div);

                  if (cb) cb(); // Call the callback
              }); // End of socket.on('my_response')

              let teller = 0;
              document.addEventListener('click', (event) => {
                  socket.emit('my_click_event', { data: teller });
                  teller++;
              }); // End of click event listener

              let send_timer = setInterval(() => {
                  socket.emit('client_timer_event', {client_id: clientId, data: teller });
                  teller++;
              }, 5000); // End of setInterval

              // Function to force a reconnect by deleting the client ID
              function forceReconnect() {
                  localStorage.removeItem('clientId');
                  location.reload();
              }

              
          }); // End of DOMContentLoaded
      </script>
    {%- endblock scripts %}
    

    {% block body -%}
      {% block navbar %}
      {% include "navigasjon.html" %}
      {%- endblock navbar %}

      {% block content -%}
        <!--Her vil koden som ligger i index.html legge seg, omsluttet av navbar og footer. -->

      {%- endblock content %}

      {% block footer %}
      {%- endblock footer %}

    {%- endblock body %}

    
  </body>
{%- endblock html %}
</html>
{% endblock doc -%}